import{r as o,u as b,j as s,B as h}from"./index-Djd5SXIv.js";import{F as k,G as M,P as R}from"./pagesStyles-snrCrkS0.js";const E=()=>{const[v,P]=o.useState([]),[l,c]=o.useState(1),[m,x]=o.useState(0),[e,p]=o.useState("popular"),[C,n]=b(),t=C.get("query")||"",i=o.useRef(!1),f=o.useCallback(async(a,y,d)=>{const u=new k;let r;try{switch(y){case"search":d&&(r=await u.getSearch(d,a));break;case"top_rated":r=await u.getTopRated(a);break;case"upcoming":r=await u.getUpcoming(a);break;case"popular":default:r=await u.getTrending(a);break}r&&r.results&&(P(r.results),x(r.total_pages))}catch(S){console.error("Error fetching movies:",S)}},[]);o.useEffect(()=>{t?(i.current=!0,p("search"),c(1),n({query:t,page:"1"})):e==="search"&&(i.current=!0,p("popular"),c(1),n({query:"",page:"1"}))},[t]),o.useEffect(()=>{if(i.current){i.current=!1;return}f(l,e,t)},[l,e,t,f]);const j=a=>{c(a),n({query:t||"",page:a.toString()})},g=a=>{p(a),c(1),n({query:a==="search"?t:"",page:"1"})};return s.jsxs(s.Fragment,{children:[s.jsx("h2",{className:"pageHeaderStyle",children:e==="search"&&t?`Search Results for "${t}"`:e==="popular"?"Popular Movies":e==="top_rated"?"Top Rated Movies":e==="upcoming"?"Upcoming Movies":""}),s.jsxs("div",{className:"buttonGroup",children:[s.jsx(h,{onClick:()=>g("popular"),className:e==="popular"?"activeButton":"",label:"Popular Movies"}),s.jsx(h,{onClick:()=>g("top_rated"),className:e==="top_rated"?"activeButton":"",label:"Top Rated"}),s.jsx(h,{onClick:()=>g("upcoming"),className:e==="upcoming"?"activeButton":"",label:"Upcoming"})]}),s.jsx(M,{movies:v}),m>1&&s.jsx(R,{currentPage:l,totalPages:m,onPageChange:j})]})};export{E as default};
