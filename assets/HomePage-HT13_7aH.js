import{r,u as S,a as k,j as t,B as h}from"./index-BgInBCaS.js";import{F as $,G as w,P as B}from"./pagesStyles-_6c75oFA.js";const T=()=>{const[P,v]=r.useState([]),[c,u]=r.useState(1),[o,f]=r.useState(0),[m,x]=S(),{category:a,query:n,setCategory:C,setQuery:j,adults:b}=k(e=>({category:e.category,query:e.query,setCategory:e.setCategory,setQuery:e.setQuery,adults:e.adults})),d=r.useCallback(async(e,y,p)=>{console.log(`Fetching movies for category: ${y}, page: ${e}, query: "${p}"`);const l=new $;let s;try{switch(y){case"search":p&&(s=await l.getSearch(p,e));break;case"top_rated":s=await l.getTopRated(e);break;case"upcoming":s=await l.getUpcoming(e);break;case"popular":default:s=await l.getTrending(e);break}if(s&&s.results){const i=Math.min(s.total_pages,500);v(s.results),f(i),console.log(`Movies fetched: ${s.results.length} movies, totalPages: ${i}`)}}catch(i){console.error("Error fetching movies:",i)}},[]);r.useEffect(()=>{d(c,a,n),c>o&&u(o)},[c,a,n,d,b,o]);const M=e=>{console.log(`Page change: new page=${e}`),u(e)},g=e=>{u(1),e!=="search"&&(j(""),m.delete("query"),x(m)),C(e),console.log(`Category change: new category=${e}`)};return t.jsxs(t.Fragment,{children:[t.jsx("h2",{className:"pageHeaderStyle",children:a==="search"&&n?`Search Results for "${n}"`:a==="popular"?"Popular Movies":a==="top_rated"?"Top Rated Movies":a==="upcoming"?"Upcoming Movies":""}),t.jsxs("div",{className:"buttonGroup",children:[t.jsx(h,{onClick:()=>g("popular"),className:a==="popular"?"activeButton":"",label:"Popular Movies"}),t.jsx(h,{onClick:()=>g("top_rated"),className:a==="top_rated"?"activeButton":"",label:"Top Rated"}),t.jsx(h,{onClick:()=>g("upcoming"),className:a==="upcoming"?"activeButton":"",label:"Upcoming"})]}),t.jsx(w,{movies:P}),o>1&&t.jsx(B,{currentPage:c,totalPages:o,onPageChange:M})]})};export{T as default};
