import{r as o,u as b,j as s,B as f}from"./index-LzFUrcm5.js";import{F as k,G as M,P as R}from"./pagesStyles-B3gnx1jT.js";const E=()=>{const[v,x]=o.useState([]),[c,n]=o.useState(1),[d,C]=o.useState(0),[e,p]=o.useState("popular"),[j,i]=b(),a=j.get("query")||"",u=o.useRef(!1),g=o.useCallback(async(t,S,P)=>{const l=new k;let r;try{switch(S){case"search":P&&(r=await l.getSearch(P,t));break;case"top_rated":r=await l.getTopRated(t);break;case"upcoming":r=await l.getUpcoming(t);break;case"popular":default:r=await l.getTrending(t);break}if(r&&r.results){const m=Math.min(r.total_pages,500);x(r.results),C(m)}}catch(m){console.error("Error fetching movies:",m)}},[]);o.useEffect(()=>{a?(u.current=!0,p("search"),c!==1?(n(1),i({query:a,page:"1"})):g(1,"search",a)):e==="search"&&(u.current=!0,p("popular"),n(1),i({query:"",page:"1"}))},[a]),o.useEffect(()=>{if(u.current){u.current=!1;return}g(c,e,a)},[c,e,a,g]);const y=t=>{n(t),i({query:a||"",page:t.toString()})},h=t=>{p(t),n(1),i({query:t==="search"?a:"",page:"1"})};return s.jsxs(s.Fragment,{children:[s.jsx("h2",{className:"pageHeaderStyle",children:e==="search"&&a?`Search Results for "${a}"`:e==="popular"?"Popular Movies":e==="top_rated"?"Top Rated Movies":e==="upcoming"?"Upcoming Movies":""}),s.jsxs("div",{className:"buttonGroup",children:[s.jsx(f,{onClick:()=>h("popular"),className:e==="popular"?"activeButton":"",label:"Popular Movies"}),s.jsx(f,{onClick:()=>h("top_rated"),className:e==="top_rated"?"activeButton":"",label:"Top Rated"}),s.jsx(f,{onClick:()=>h("upcoming"),className:e==="upcoming"?"activeButton":"",label:"Upcoming"})]}),s.jsx(M,{movies:v}),d>1&&s.jsx(R,{currentPage:c,totalPages:d,onPageChange:y})]})};export{E as default};
